var http = require('http');
var superagent = require('superagent');

exports.index =function(req, res){
	var translationText=	req.query.text;
	var targetLanguage=req.query.tl;
	var currentLanguage=req.query.cl;
	SendTestToGoogle(translationText,targetLanguage,currentLanguage)
	console.log(translationText+'已发送');
	 res.json({success: 0})
}


function SendTestToGoogle(text,tl,cl){
	var para ={
            'client': 'z',
            'sl': cl,
            'tl': tl,
            'ie': 'UTF-8',
            'oe': 'UTF-8',
            'text': text
            };



var options = {};
 
//最终请求地址
options.path = 'http://translate.google.com/translate_a/t';
 
//这里代理到fiddler
options.host = '127.0.0.1';
options.port = 8580;
options.method='POST'
 var body = '';
var req = http.request(options, function(res) {
	
  console.log("Got response: " + res.statusCode);
  res.on('data',function(d){
body += d;
 }).on('end', function(){
 	debugger;
  console.log(body)
 });

}).on('error', function(e) {
  console.log("Got error: " + e.message);
});
req.write(require('querystring').stringify(para));
req.end();
}